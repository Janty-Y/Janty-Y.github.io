!function(e){function t(t){for(var i,n,h=t[0],l=t[1],o=t[2],d=0,p=[];d<h.length;d++)n=h[d],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&p.push(a[n][0]),a[n]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);for(c&&c(t);p.length;)p.shift()();return r.push.apply(r,o||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],i=!0,h=1;h<s.length;h++){var l=s[h];0!==a[l]&&(i=!1)}i&&(r.splice(t--,1),e=n(n.s=s[0]))}return e}var i={},a={0:0},r=[];function n(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=i,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var h=window.webpackJsonp=window.webpackJsonp||[],l=h.push.bind(h);h.push=t,h=h.slice();for(var o=0;o<h.length;o++)t(h[o]);var c=l;r.push([1,1]),s()}([,function(e,t,s){"use strict";s.r(t);var i=s(0),a=s.n(i);var r=class{constructor(e,t,s,i=1,r){this.bar=new a.a.GameObjects.Graphics(e),this.bar.setScrollFactor(0,0),this.x=t/i,this.y=s/i,this.scale=i,this.value=r,this.size={width:40,height:8},this.pixelPerHealth=this.size.width/this.value,e.add.existing(this.bar),this.draw(this.x,this.y,this.scale)}decrease(e){this.value=e<=0?0:e,this.value=e,this.draw(this.x,this.y,this.scale)}draw(e,t,s){this.bar.clear();const{width:i,height:a}=this.size;this.bar.fillStyle(0),this.bar.fillRect(e,t,i+3,a+3),this.bar.fillStyle(16777215),this.bar.fillRect(e+3,t+3,i-3,a-3);const r=Math.floor(this.value*this.pixelPerHealth);return r<=this.size.width/3?this.bar.fillStyle(16711680):this.bar.fillStyle(65280),r>0&&this.bar.fillRect(e+3,t+3,r-3,a-3),this.bar.setScrollFactor(0,0).setScale(s)}},n={addCollider(e,t,s){return this.scene.physics.add.collider(this,e,t,null,s||this),this},addOverlap(e,t,s){return this.scene.physics.add.overlap(this,e,t,null,s||this),this},bodyPositionDifferenceX:0,previousRayL:null,prevHasHit:null,raycast(e,t,{raylength:s=30,precision:i=0,steepness:r=1}){const{x:n,y:h,width:l,halfHeight:o}=e;if(this.bodyPositionDifferenceX+=e.x-e.prev.x,Math.abs(this.bodyPositionDifferenceX)<=i&&null!==this.prevHasHit)return{ray:this.previousRayL,hasHit:this.prevHasHit};const c=new a.a.Geom.Line;let d=!1;switch(e.facing){case a.a.Physics.Arcade.FACING_RIGHT:c.x1=n+l,c.y1=h+o,c.x2=c.x1+s*r,c.y2=c.y1+s;break;case a.a.Physics.Arcade.FACING_LEFT:c.x1=n,c.y1=h+o,c.x2=c.x1-s*r,c.y2=c.y1+s}const p=t.getTilesWithinShape(c);return p.length>0&&(d=this.prevHasHit=p.some((e=>-1!==e.index))),this.previousRayL=c,this.bodyPositionDifferenceX=0,{ray:c,hasHit:d}}},h={isPlayingAnims(e){return this.anims.isPlaying&&this.anims.getCurrentKey()===e}};class l extends a.a.Physics.Arcade.Sprite{constructor(e,t,s,i,a){super(e,t,s),e.add.existing(this),e.physics.add.existing(this),this.target=null,this.effectName=i,this.impactPosition=a,this.on("animationcomplete",(e=>{e.key===this.effectName&&this.destroy()}),this)}preUpdate(e,t){super.preUpdate(e,t),this.placeEffect()}placeEffect(){if(!this.target||!this.body)return;const e=this.target.getCenter();this.body.reset(e.x,this.impactPosition.y)}playOn(e){this.target=e,this.play(this.effectName,!0),this.placeEffect()}}var o=l;var c=class{constructor(e){this.scene=e}playEffectOn(e,t,s){new o(this.scene,0,0,e,s).playOn(t)}};class d extends a.a.Physics.Arcade.Sprite{constructor(e,t,s,i){super(e,t,s,i),e.add.existing(this),e.physics.add.existing(this),this.speed=300,this.maxDistance=1400,this.traveledDistance=0,this.damage=10,this.cooldown=400,this.body.setSize(this.width-13,this.height-20),this.effectManager=new c(this.scene)}preUpdate(e,t){super.preUpdate(e,t),this.traveledDistance+=this.body.deltaAbsX(),this.isOutOfRange()&&(this.body.reset(0,0),this.activateProjectile(!1),this.traveledDistance=0)}fire(e,t,s){this.activateProjectile(!0),this.body.reset(e,t),this.setVelocityX(this.speed),s&&this.play(s,!0)}deliversHit(e){this.activateProjectile(!1),this.traveledDistance=0;const t={x:this.x,y:this.y};this.body.reset(0,0),this.effectManager.playEffectOn("hit-effect",e,t)}activateProjectile(e){this.setActive(e),this.setVisible(e)}isOutOfRange(){return this.traveledDistance&&this.traveledDistance>=this.maxDistance}}var p=d;const u=()=>(new Date).getTime();class m extends a.a.Physics.Arcade.Group{constructor(e,t){super(e.physics.world,e),this.createMultiple({frameQuantity:5,active:!1,visible:!1,key:t,classType:p}),this.timeFromLastProjectile=null}fireProjectile(e,t){const s=this.getFirstDead(!1);if(this.maxDistance=50,!s)return;if(this.timeFromLastProjectile&&this.timeFromLastProjectile+s.cooldown>u())return;const i=e.getCenter();let r;e.lastDirection===a.a.Physics.Arcade.FACING_RIGHT?(s.speed=Math.abs(s.speed),s.setFlipX(!1),r=i.x+45):(s.speed=-Math.abs(s.speed),s.setFlipX(!0),r=i.x-45),s.fire(i.x,i.y,t),this.timeFromLastProjectile=u()}}var y=m;class g extends a.a.Physics.Arcade.Sprite{constructor(e,t,s,i){super(e,t,s,i),e.add.existing(this),e.physics.add.existing(this),this.damage=20,this.attackSpeed=500,this.weaponAnim=i+"-swing",this.wielder=null,this.effectManager=new c(this.scene),this.setOrigin(.5,1),this.setDepth(10),this.setTintFill(15267064),this.activateWeapon(!1),this.on("animationcomplete",(e=>{e.key===this.weaponAnim&&(this.activateWeapon(!1),this.body.checkCollision.none=!1,this.body.reset(0,0))}))}preUpdate(e,t){super.preUpdate(e,t),this.active&&(this.wielder.lastDirection===a.a.Physics.Arcade.FACING_RIGHT?(this.setFlipX(!1),this.body.reset(this.wielder.x+15,this.wielder.y)):(this.setFlipX(!0),this.body.reset(this.wielder.x-15,this.wielder.y)))}swing(e){this.wielder=e,this.activateWeapon(!0),this.anims.play(this.weaponAnim,!0)}deliversHit(e){const t={x:this.x,y:this.getRightCenter().y};this.effectManager.playEffectOn("hit-effect",e,t),this.body.checkCollision.none=!0}activateWeapon(e){this.setActive(e),this.setVisible(e)}}var f=g;class b extends a.a.Events.EventEmitter{constructor(){super()}}var v=new b;class k extends a.a.Physics.Arcade.Sprite{constructor(e,t,s){super(e,t,s,"player"),this.setScale(1.5),e.add.existing(this),e.physics.add.existing(this),Object.assign(this,n),Object.assign(this,h),this.init(),this.initEvents()}init(){this.height=50,this.gravity=500,this.playerSpeed=150,this.jumpCount=0,this.consecutiveJumps=1,this.hasBeenHit=!1,this.isSliding=!1,this.bounceVelocity=250,this.cursors=this.scene.input.keyboard.createCursorKeys(),this.jumpSound=this.scene.sound.add("jump",{volume:.2}),this.projectileSound=this.scene.sound.add("projectile-launch",{volume:.2}),this.runningSound=this.scene.sound.add("running",{volume:.2}),this.swipeSound=this.scene.sound.add("swipe",{volume:.2}),this.lastDirection=a.a.Physics.Arcade.FACING_RIGHT,this.projectiles=new y(this.scene,"iceball-1"),this.meleeWeapon=new f(this.scene,0,0,"sword-default"),this.timeFromLastSwing=null,this.health=50,this.hp=new r(this.scene,this.scene.config.leftTopCorner.x+5,this.scene.config.leftTopCorner.y+5,2,this.health),this.body.setSize(20,24),this.body.setGravityY(this.gravity),this.setCollideWorldBounds(!0),this.setOrigin(.5,1),(e=>{e.create({key:"idle",frames:e.generateFrameNumbers("player",{start:38,end:41}),frameRate:5,repeat:-1}),e.create({key:"run",frames:e.generateFrameNumbers("player-run",{start:0,end:5}),frameRate:8,repeat:-1}),e.create({key:"jump",frames:e.generateFrameNumbers("player",{start:16,end:23}),frameRate:5,repeat:-1}),e.create({key:"throw",frames:e.generateFrameNumbers("player-throw",{start:8,end:13}),frameRate:14,repeat:0}),e.create({key:"slide",frames:e.generateFrameNumbers("player",{start:24,end:27}),frameRate:20,repeat:0})})(this.scene.anims),this.handleAttacks(),this.handleMovements(),this.scene.time.addEvent({delay:400,repeat:-1,callbackScope:this,callback:()=>{this.isPlayingAnims("run")&&this.runningSound.play()}})}initEvents(){this.scene.events.on(a.a.Scenes.Events.UPDATE,this.update,this)}update(){if(this.hasBeenHit||this.isSliding||!this.body)return;this.getBounds().top>this.scene.config.height&&v.emit("PLAYER_LOSE");const{left:e,right:t,space:s}=this.cursors,i=a.a.Input.Keyboard.JustDown(s),r=this.body.onFloor();e.isDown?(this.lastDirection=a.a.Physics.Arcade.FACING_LEFT,this.setVelocityX(-this.playerSpeed),this.setFlipX(!0)):t.isDown?(this.lastDirection=a.a.Physics.Arcade.FACING_RIGHT,this.setVelocityX(this.playerSpeed),this.setFlipX(!1)):this.setVelocityX(0),i&&(r||this.jumpCount<this.consecutiveJumps)&&(this.jumpSound.play(),this.setVelocityY(2*-this.playerSpeed),this.jumpCount++),r&&(this.jumpCount=0),this.isPlayingAnims("throw")||this.isPlayingAnims("slide")||(r?0!==this.body.velocity.x?this.play("run",!0):this.play("idle",!0):this.play("jump",!0))}handleAttacks(){this.scene.input.keyboard.on("keydown-Q",(()=>{this.projectileSound.play(),this.play("throw",!0),this.projectiles.fireProjectile(this,"iceball")})),this.scene.input.keyboard.on("keydown-E",(()=>{this.timeFromLastSwing&&this.timeFromLastSwing+this.meleeWeapon.attackSpeed>u()||(this.swipeSound.play(),this.play("throw",!0),this.meleeWeapon.swing(this),this.timeFromLastSwing=u())}))}handleMovements(){this.scene.input.keyboard.on("keydown-DOWN",(()=>{this.body.setSize(this.width/2,this.height/2),this.setOffset(10,this.height/2),this.isSliding=!0,this.play("slide",!0),this.setVelocity(0,0)})),this.scene.input.keyboard.on("keyup-DOWN",(()=>{this.body.setSize(20,27),this.setVelocityX(0),this.body.height=50,this.isSliding=!1}))}playDamageTween(){return this.scene.tweens.add({targets:this,duration:100,repeat:-1,tint:16777215})}bounceOff(e){e.body?this.body.touching.right?this.setVelocityX(.5*-this.bounceVelocity,-this.bounceVelocity):this.setVelocityX(.5*this.bounceVelocity,-this.bounceVelocity):this.body.blocked.right?this.setVelocityX(.5*-this.bounceVelocity,-this.bounceVelocity):this.setVelocityX(.5*this.bounceVelocity,-this.bounceVelocity),setTimeout((()=>this.setVelocityY(-this.bounceVelocity)),0)}takesHit(e){if(this.hasBeenHit)return;if(this.health-=e.damage||e.properties.damage||0,this.health<=0)return void v.emit("PLAYER_LOSE");this.hasBeenHit=!0,this.bounceOff(e);const t=this.playDamageTween();this.hp.decrease(this.health),e.deliversHit&&e.deliversHit(this),this.scene.time.delayedCall(1e3,(()=>{this.hasBeenHit=!1,t.stop(),this.clearTint()}))}}var S=k;class w extends a.a.Physics.Arcade.Sprite{constructor(e,t,s,i){super(e,t,s,i),e.add.existing(this),e.physics.add.existing(this),this.config=e.config,Object.assign(this,n),Object.assign(this,h),this.init(),this.initEvents()}init(){this.gravity=500,this.speed=100,this.timeFromLastTurn=0,this.maxPatrolDistance=500,this.currentPatrolDistance=0,this.health=50,this.damage=10,this.isDead=!1,this.platformCollidersLayer=null,this.rayGraphics=this.scene.add.graphics({lineStyle:{width:2,color:11141290}}),this.body.setGravityY(this.gravity),this.setCollideWorldBounds(!0),this.setOrigin(.5,1),this.setImmovable(!0),this.setVelocityX(this.speed)}initEvents(){this.scene.events.on(a.a.Scenes.Events.UPDATE,this.update,this)}update(e){if(this.getBounds().bottom>600)return this.scene.events.removeListener(a.a.Scenes.Events.UPDATE,this.update,this),this.setActive(!1),this.rayGraphics.clear(),void this.destroy();this.patrol(e)}patrol(e){if(!this.body||!this.body.onFloor())return;this.currentPatrolDistance+=Math.abs(this.body.deltaX());const{ray:t,hasHit:s}=this.raycast(this.body,this.platformCollidersLayer,{raylength:35,precision:1,steepness:2});(!s||this.currentPatrolDistance>=this.maxPatrolDistance)&&this.timeFromLastTurn+100<e&&(this.setFlipX(!this.flipX),this.setVelocityX(this.speed=-this.speed),this.timeFromLastTurn=e,this.currentPatrolDistance=0),this.config.debug&&t&&(this.rayGraphics.clear(),this.rayGraphics.strokeLineShape(t))}setPlatformColliders(e){this.platformCollidersLayer=e}deliversHit(){}takesHit(e){if(e.deliversHit(this),this.health-=e.damage,this.health<=0)return this.setTint(16711680),this.setVelocity(0,-200),this.body.checkCollision.none=!0,this.setCollideWorldBounds(!1),this.isDead=!0,this.scoreVal;this.isDead=!1}}var x=w;var P=class extends x{constructor(e,t,s){super(e,t,s,"birdman"),(e=>{e.create({key:"birdman-idle",frames:e.generateFrameNumbers("birdman",{start:0,end:12}),frameRate:8,repeat:-1}),e.create({key:"birdman-hurt",frames:e.generateFrameNumbers("birdman",{start:25,end:26}),frameRate:5,repeat:0})})(e.anims)}init(){super.init(),this.setSize(20,45),this.setOffset(7,20)}update(e,t){super.update(e,t),this.active&&(this.isPlayingAnims("birdman-hurt")||this.play("birdman-idle",!0))}takesHit(e){super.takesHit(e),this.play("birdman-hurt",!0)}};var _=class extends x{constructor(e,t,s){super(e,t,s,"snaky"),(e=>{e.create({key:"snaky-walk",frames:e.generateFrameNumbers("snaky",{start:0,end:8}),frameRate:8,repeat:-1}),e.create({key:"snaky-hurt",frames:e.generateFrameNumbers("snaky",{start:21,end:22}),frameRate:5,repeat:0})})(e.anims)}init(){super.init(),this.speed=50,this.setScale(1.3),this.projectiles=new y(this.scene,"fireball-1"),this.timeFromLastAttack=0,this.attackDelay=this.getAttackDelay(),this.lastDirection=null,this.setSize(12,45),this.setOffset(10,15),this.health=40,this.scoreVal=20}update(e,t){super.update(e,t),this.active&&(this.body.velocity.x>0?this.lastDirection=Phaser.Physics.Arcade.FACING_RIGHT:this.lastDirection=Phaser.Physics.Arcade.FACING_LEFT,this.health<=0||(this.timeFromLastAttack+this.attackDelay<=e&&(this.projectiles.fireProjectile(this,"fireball"),this.timeFromLastAttack=e,this.attackDelay=this.getAttackDelay()),this.active&&(this.isPlayingAnims("snaky-hurt")||this.play("snaky-walk",!0))))}getAttackDelay(){return Phaser.Math.Between(1e3,4e3)}takesHit(e){super.takesHit(e),this.play("snaky-hurt",!0)}};var C=class extends x{constructor(e,t,s){super(e,t,s,"slime"),(e=>{e.create({key:"slime-idle",frames:e.generateFrameNumbers("slime",{start:0,end:3}),frameRate:8,repeat:-1}),e.create({key:"slime-jump",frames:e.generateFrameNumbers("slime",{start:9,end:14}),frameRate:6,repeat:0}),e.create({key:"slime-hurt",frames:e.generateFrameNumbers("slime",{start:20,end:21}),frameRate:5,repeat:0})})(e.anims)}init(){super.init(),this.setSize(this.width/3,this.height/2-8),this.setOffset(20,28),this.health=20,this.timeFromLastAttack=0,this.attackDelay=this.getAttackDelay(),this.lastDirection=null,this.maxPatrolDistance=200,this.speed=20}update(e,t){super.update(e,t),this.active&&(this.isPlayingAnims("slime-hurt")||(this.body.onFloor()?this.play("slime-idle",!0):this.play("slime-jump",!0),this.body.velocity.x>0?this.lastDirection=Phaser.Physics.Arcade.FACING_RIGHT:this.lastDirection=Phaser.Physics.Arcade.FACING_LEFT,this.health<=0||this.timeFromLastAttack+this.attackDelay<=e&&(this.jumpAttack(),this.timeFromLastAttack=e,this.attackDelay=this.getAttackDelay())))}getAttackDelay(){return Phaser.Math.Between(4e3,6e3)}jumpAttack(){this.setVelocityY(-400)}takesHit(e){super.takesHit(e),this.play("slime-hurt",!0)}};const A={Birdman:P,Snaky:_,Slime:C,Skeleton:class extends x{constructor(e,t,s){super(e,t,s,"skele"),(e=>{e.create({key:"skele-idle",frames:e.generateFrameNumbers("skele",{start:26,end:37}),frameRate:8,repeat:-1}),e.create({key:"skele-hurt",frames:e.generateFrameNumbers("skele",{start:13,end:14}),frameRate:5,repeat:0}),e.create({key:"skele-swing",frames:e.generateFrameNumbers("skele",{start:3,end:11}),frameRate:12,repeat:0})})(e.anims),this.play("skele-idle",!0)}init(){super.init(),this.setSize(this.width/3,this.height/2),this.setOffset(20,15),this.health=70,this.timeFromLastAttack=0,this.attackDelay=this.getAttackDelay(),this.lastDirection=null,this.maxPatrolDistance=300,this.speed=60,this.setScale(1.3)}update(e,t){super.update(e,t),this.active&&(this.isPlayingAnims("skele-hurt")||this.health<=0||(this.body.onFloor()?(this.play("skele-idle",!0),this.setSize(this.width/3,this.height/2)):(this.play("skele-swing",!0),this.body.setSize(this.width/1.5,this.height/2)),this.body.velocity.x>0?this.lastDirection=Phaser.Physics.Arcade.FACING_RIGHT:this.lastDirection=Phaser.Physics.Arcade.FACING_LEFT,this.health<=0||this.timeFromLastAttack+this.attackDelay<=e&&(this.handleAttack(),this.setVelocityX(this.speed),this.timeFromLastAttack=e,this.attackDelay=this.getAttackDelay())))}handleAttack(){this.setVelocityY(-350)}getAttackDelay(){return Phaser.Math.Between(3e3,6e3)}takesHit(e){super.takesHit(e),this.play("skele-hurt",!0)}}};class O extends a.a.GameObjects.Group{constructor(e){super(e),Object.assign(this,n)}getProjectiles(){const e=new a.a.GameObjects.Group;return this.getChildren().forEach((t=>{t.projectiles&&e.addMultiple(t.projectiles.getChildren())})),e}getTypes(){return A}}var F=O;class D extends a.a.Physics.Arcade.Sprite{constructor(e,t,s,i){super(e,t,s,i),e.add.existing(this),this.score=1,this.setOrigin(0,1),e.tweens.add({targets:this,y:this.y-5,duration:a.a.Math.Between(1500,2500),repeat:-1,easy:"linear",yoyo:!0})}}var j=D;class L extends a.a.Physics.Arcade.StaticGroup{constructor(e){super(e.physics.world,e),this.createFromConfig({classType:j})}mapProperties(e){return e&&0!==e.length?e.reduce(((e,t)=>(e[t.name]=t.value,e)),{}):{}}addFromLayer(e){const{score:t,type:s}=this.mapProperties(e.properties);e.objects.forEach((e=>{const i=this.get(e.x,e.y,s),a=this.mapProperties(e.properties);i.score=a.score||t}))}}var H=L;let E=0;class T extends a.a.GameObjects.Container{constructor(e,t,s){super(e,t,s),e.add.existing(this);const{rightTopCorner:i}=e.config;this.containerWidth=70,this.setPosition(i.x-this.containerWidth-30,i.y+10),this.setScrollFactor(0),this.setDepth(99),this.fontSize=16,this.setupList(),this.updateScoreBoard(E)}setupList(){const e=this.createScoreBoard();this.add([e]);let t=0;this.list.forEach((e=>{e.setPosition(e.x,e.y+t),t+=20}))}createScoreBoard(){const e=this.scene.add.text(0,0,"0",{fontSize:this.fontSize+"px",fill:"#fff"}),t=this.scene.add.image(e.width+5,0,"diamond").setScale(1.3).setOrigin(0);let s=null;s=null===localStorage.getItem("bestScore")?0:localStorage.getItem("bestScore");const i=this.scene.add.text(0,20,"Best: "+s,{fontSize:"14px",fill:"#fff"}),a=this.scene.add.container(0,0,[e,t,i]);return a.setName("scoreBoard"),a}updateScoreBoard(e){const[t,s]=this.getByName("scoreBoard").list;t.setText(e),s.setX(t.width+5)}setCurrentScore(e){E=e}getCurrentScore(){return E}}var G=T;class B extends a.a.Scene{constructor(e){super("PlayScene"),this.config=e}create({gameStatus:e}){this.hud=new G(this,0,0),this.score=this.hud.getCurrentScore(),this.playBGMusic(),this.collectSound=this.sound.add("coin-pickup",{volume:.2});const t=this.createMap();(e=>{e.create({key:"hit-effect",frames:e.generateFrameNumbers("hit-sheet",{start:0,end:4}),frameRate:10,repeat:0}),e.create({key:"sword-default-swing",frames:e.generateFrameNumbers("sword-default",{start:0,end:2}),frameRate:20,repeat:0}),e.create({key:"fireball",frames:[{key:"fireball-1"},{key:"fireball-2"},{key:"fireball-3"}],frameRate:5,repeat:-1}),e.create({key:"iceball",frames:[{key:"iceball-1"},{key:"iceball-2"}],frameRate:5,repeat:-1}),e.create({key:"diamond-shine",frames:[{key:"diamond-1"},{key:"diamond-2"},{key:"diamond-3"},{key:"diamond-4"},{key:"diamond-5"},{key:"diamond-6"}],frameRate:4,repeat:-1})})(this.anims);const s=this.createLayers(t),i=this.getPlayerZones(s.playerZones),a=this.createPlayer(i.start),r=this.createEnemies(s.enemySpawns,s.platformColliders),n=this.createCollectibles(s.collectibles);this.createEnemyColliders(r,{colliders:{platformColliders:s.platformColliders,player:a}}),this.createPlayerColliders(a,{colliders:{platformColliders:s.platformColliders,projectiles:r.getProjectiles(),collectibles:n,traps:s.traps}}),this.createBG(t),this.createBackButton(),this.createEndOfLevel(i.end,a),this.setupFollowupCameraOn(a),"PLAYER_LOSE"!==e?this.createGameEvents():this.hud.setCurrentScore(0)}playBGMusic(){this.sound.get("theme")}createMap(){const e=this.make.tilemap({key:"level_"+this.getCurrentLevel()});return e.addTilesetImage("main_lev_build_1","tiles-1"),e.addTilesetImage("main_lev_build_2","tiles-2"),e.addTilesetImage("grassy_tileset","tiles-3"),e.addTilesetImage("night_tileset","tiles-4"),e.addTilesetImage("bg_spikes_tileset","bg-spikes-tileset"),e}createLayers(e){const t=e.getTileset("main_lev_build_1"),s=e.getTileset("main_lev_build_2"),i=e.getTileset("grassy_tileset"),a=e.getTileset("night_tileset"),r=e.getTileset("bg_spikes_tileset");e.createStaticLayer("distance",r).setDepth(-12);const n=e.createStaticLayer("Platform_Colliders",t).setAlpha(0),h=e.createStaticLayer("Environment",[t,s,i,a]).setDepth(-2),l=e.createStaticLayer("Platforms",[t,s,i,a]),o=e.getObjectLayer("player_zones"),c=e.getObjectLayer("enemy_spawns"),d=e.getObjectLayer("collectibles"),p=e.createStaticLayer("traps",t);return n.setCollisionByExclusion(-1,!0),p.setCollisionByExclusion(-1),{environment:h,platforms:l,platformColliders:n,playerZones:o,enemySpawns:c,collectibles:d,traps:p}}createBG(e){const t=e.getObjectLayer("distance_bg").objects[0];this.spikesImage=this.add.tileSprite(t.x,t.y,this.config.width,t.height,"bg-spikes-dark").setOrigin(0,1).setDepth(-10).setAlpha(1).setScrollFactor(0,1),this.skyImage=this.add.tileSprite(0,0,this.config.width,180,"sky-play").setOrigin(0,0).setDepth(-11).setScale(2).setAlpha(1).setScrollFactor(0,1)}createBackButton(){this.add.image(this.config.rightBottomCorner.x,this.config.rightBottomCorner.y,"back").setOrigin(1).setScrollFactor(0).setScale(2).setInteractive().on("pointerup",(()=>{this.hud.setCurrentScore(0),this.scene.start("MenuScene")}))}createGameEvents(){v.on("PLAYER_LOSE",(()=>{this.scene.restart({gameStatus:"PLAYER_LOSE"})}))}createCollectibles(e){const t=new H(this).setDepth(-1);return t.addFromLayer(e),t.playAnimation("diamond-shine"),t}createPlayer(e){return new S(this,e.x,e.y)}createEnemies(e,t){const s=new F(this),i=s.getTypes();return e.objects.forEach(((e,a)=>{const r=new i[e.type](this,e.x,e.y);r.setPlatformColliders(t),s.add(r)})),s}onPlayerCollision(e,t){t.takesHit(e)}onHit(e,t){this.isDead=!1,e.takesHit(t),e.isDead&&(this.scene.score+=5,this.scene.hud.updateScoreBoard(this.scene.score))}onCollect(e,t){this.score+=t.score,this.hud.updateScoreBoard(this.score),this.collectSound.play(),t.disableBody(!0,!0)}createEnemyColliders(e,{colliders:t}){e.addCollider(t.platformColliders).addCollider(t.player,this.onPlayerCollision).addCollider(t.player.projectiles,this.onHit).addOverlap(t.player.meleeWeapon,this.onHit)}createPlayerColliders(e,{colliders:t}){e.addCollider(t.platformColliders).addCollider(t.projectiles,this.onHit).addCollider(t.traps,this.onHit).addOverlap(t.skm,this.onHit).addOverlap(t.collectibles,this.onCollect,this)}setupFollowupCameraOn(e){const{height:t,width:s,mapOffset:i,zoomFactor:a}=this.config;this.physics.world.setBounds(0,0,s+i,t+200),this.cameras.main.setBounds(0,0,s+i,t).setZoom(a),this.cameras.main.startFollow(e)}getPlayerZones(e){const t=e.objects;return{start:t.find((e=>"startZone"===e.name)),end:t.find((e=>"endZone"===e.name))}}getCurrentLevel(){return this.registry.get("level")||1}createEndOfLevel(e,t){const s=this.physics.add.sprite(e.x,e.y,"end").setAlpha(0).setSize(5,this.config.height).setOrigin(.5,1),i=this.physics.add.overlap(t,s,(()=>{if(i.active=!1,this.registry.get("level")===this.config.lastLevel){const e=localStorage.getItem("yourScore");e&&parseInt(e,10);localStorage.setItem("yourScore",this.score),this.scene.start("CreditsScene"),this.registry.set("level",1);const t=localStorage.getItem("bestScore"),s=t&&parseInt(t,10);return(!s||this.score>s)&&localStorage.setItem("bestScore",this.score),void this.hud.setCurrentScore(0)}this.hud.setCurrentScore(this.score),this.registry.inc("level",1),this.scene.restart({gameStatus:" LEVEL_COMPLETETD"})}))}update(){this.spikesImage.tilePositionX=.3*this.cameras.main.scrollX,this.skyImage.tilePositionX=.1*this.cameras.main.scrollX}}var I=B;class N extends a.a.Scene{constructor(){super("PreloadScene")}preload(){this.load.tilemapTiledJSON("level_1","assets/lvl_1.json"),this.load.tilemapTiledJSON("level_2","assets/lvl_2.json"),this.load.tilemapTiledJSON("level_3","assets/lvl_3.json"),this.load.tilemapTiledJSON("level_4","assets/lvl_4.json"),this.load.tilemapTiledJSON("level_5","assets/lvl_5.json"),this.load.image("tiles-1","assets/main_lev_build_1.png"),this.load.image("tiles-2","assets/main_lev_build_2.png"),this.load.image("tiles-3","assets/grassy_tileset.png"),this.load.image("tiles-4","assets/night_tileset.png"),this.load.image("bg-spikes-tileset","assets/bg_spikes_tileset.png"),this.load.image("bg-spikes-dark","assets/bg_spikes_dark.png"),this.load.image("sky-play","assets/sky_play.png"),this.load.image("menu-bg","assets/background01.png"),this.load.image("back","assets/back.png"),this.load.image("iceball-1","assets/weapons/iceball_001.png"),this.load.image("iceball-2","assets/weapons/iceball_002.png"),this.load.image("fireball-1","assets/weapons/improved_fireball_001.png"),this.load.image("fireball-2","assets/weapons/improved_fireball_002.png"),this.load.image("fireball-3","assets/weapons/improved_fireball_003.png"),this.load.image("diamond","assets/collectibles/diamond.png"),this.load.image("diamond-1","assets/collectibles/diamond_big_01.png"),this.load.image("diamond-2","assets/collectibles/diamond_big_02.png"),this.load.image("diamond-3","assets/collectibles/diamond_big_03.png"),this.load.image("diamond-4","assets/collectibles/diamond_big_04.png"),this.load.image("diamond-5","assets/collectibles/diamond_big_05.png"),this.load.image("diamond-6","assets/collectibles/diamond_big_06.png"),this.load.spritesheet("player","assets/player/hero.png",{frameWidth:50,frameHeight:37}),this.load.spritesheet("player-run","assets/player/hero_run.png",{frameWidth:50,frameHeight:37}),this.load.spritesheet("player-throw","assets/player/hero_combat.png",{frameWidth:50,frameHeight:37}),this.load.spritesheet("birdman","assets/enemy/enemy_sheet.png",{frameWidth:32,frameHeight:64,spacing:32}),this.load.spritesheet("snaky","assets/enemy/enemy_sheet_2.png",{frameWidth:32,frameHeight:64,spacing:32}),this.load.spritesheet("slime","assets/enemy/Slime_Spiked_Full.png",{frameWidth:64,frameHeight:64}),this.load.spritesheet("skele","assets/enemy/skeleton.png",{frameWidth:64,frameHeight:64}),this.load.spritesheet("hit-sheet","assets/weapons/hit_effect_sheet.png",{frameWidth:32,frameHeight:32}),this.load.spritesheet("sword-default","assets/weapons/sword_sheet_1.png",{frameWidth:52,frameHeight:32,spacing:16}),this.load.audio("theme","assets/music/theme_music.wav"),this.load.audio("projectile-launch","assets/music/projectile_launch.wav"),this.load.audio("running","assets/music/step.wav"),this.load.audio("jump","assets/music/jump.wav"),this.load.audio("swipe","assets/music/swipe.wav"),this.load.audio("coin-pickup","assets/music/coin_pickup.wav"),this.load.once("complete",(()=>{this.startGame()}))}startGame(){this.registry.set("level",1),this.registry.set("unlocked-levels",1),this.scene.start("MenuScene")}}var R=N;class M extends a.a.Scene{constructor(e,t){super(e),this.config=t,this.screenCenter=[t.width/2,t.height/4],this.fontSize=80,this.lineHeight=120,this.fontOptions={fontSize:this.fontSize+"px",fill:"#30de1d"}}create(){if(this.add.image(0,0,"menu-bg").setOrigin(0).setScale(2),this.config.canGoBack){this.add.image(this.config.width-10,this.config.height-10,"back").setOrigin(1).setScale(2).setInteractive().on("pointerup",(()=>{this.scene.start("MenuScene")}))}}createMenu(e,t){let s=0;e.forEach((e=>{const i=[this.screenCenter[0],this.screenCenter[1]+s];e.textGO=this.add.text(...i,e.text,this.fontOptions).setOrigin(.5,1),s+=this.lineHeight,t(e)}))}}var V=M;var X=class extends V{constructor(e){super("MenuScene",e),this.menu=[{scene:"PlayScene",text:"Play"},{scene:"ControlScene",text:"Controls"},{scene:"ScoreScene",text:"Best Score"},{scene:null,text:"Exit"}]}create(){super.create(),this.createMenu(this.menu,this.setupMenuEvents.bind(this))}setupMenuEvents(e){const t=e.textGO;t.setInteractive(),t.on("pointerover",(()=>{t.setStyle({fill:"#ff0"})})),t.on("pointerout",(()=>{t.setStyle({fill:"#30de1d"})})),t.on("pointerup",(()=>{e.scene&&this.scene.start(e.scene),"Exit"===e.text&&this.game.destroy(!0),this.registry.set("level",1)}))}};var W=class extends V{constructor(e){super("CreditsScene",{...e,canGoBack:!0})}create(){super.create();const e=localStorage.getItem("yourScore");this.menu=[{scene:null,text:"All levels completed!"},{scene:null,text:"Thank you for playing!"},{scene:null,text:"Your score: "+e}],localStorage.setItem("yourScore",0),this.createMenu(this.menu,(()=>{}))}};var z=class extends V{constructor(e){super("ScoreScene",{...e,canGoBack:!0})}create(){super.create();const e=localStorage.getItem("bestScore");this.add.text(...this.screenCenter,"Best Score: "+(e||0),this.fontOptions).setOrigin(.5);const t=this.add.text(this.config.width/2,this.config.height/2+82,"Clear Score",this.fontOptions).setOrigin(.5).setInteractive();t.on("pointerover",(()=>{t.setStyle({fill:"#ff0"})})),t.on("pointerout",(()=>{t.setStyle({fill:"#fff"})})),t.on("pointerup",(()=>{localStorage.clear(),this.scene.restart()}))}};var Y=class extends V{constructor(e){super("ControlScene",{...e,canGoBack:!0})}create(){super.create(),this.menu=[{scene:null,text:"Melee: E"},{scene:null,text:"Projectile: Q"},{scene:null,text:"Jump: Spacebar"},{scene:null,text:"Movement: Arrow Keys"}],this.createMenu(this.menu,(()=>{}))}};const J=document.body.offsetWidth,U=632,Z=1.5,K={mapOffset:2400>J?2400-J:0,width:J,height:U,zoomFactor:Z,debug:!1,leftTopCorner:{x:(J-J/Z)/2,y:105.33333333333334},rightTopCorner:{x:J/Z+(J-J/Z)/2,y:105.33333333333334},rightBottomCorner:{x:J/Z+(J-J/Z)/2,y:526.6666666666666},lastLevel:5},Q=[R,X,z,I,W,Y],q=e=>new e(K),$={type:a.a.AUTO,...K,pixelArt:!0,physics:{default:"arcade",arcade:{debug:K.debug}},scene:Q.map(q)};new a.a.Game($)}]);